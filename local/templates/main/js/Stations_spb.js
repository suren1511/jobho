var emptyText="",divStyle='style="vertical-align:middle;font-size:11px; padding:0; margin:0;"',inputStyle='style="padding:0; margin:0;width:9px; height:9px;vertical-align:middle"',labelStyle='style="font-size:11px;"';function updateSel(){if(IE){var e=document.getElementById("selectedStations"),t=e.innerHTML;e.innerHTML=t}}var k=0,i=0,count=0,lines=[],stByLine=[],centerStation=[0,1,2,4,9,12,13,14,15,27,31,34,36,39,40,41,43,44,50,51,54,55,58,59,61,66,67,68,69,72,73,77,78,82,83,90,93,99,100,101,109,111,112,115,116,118,122,123,125,128,129,130,133,134,136,139,142,145,150,153,159,167,168,175,176,177,180,3,7,8,18,19,52,60,62,64,70,75,88,98,110,113,120,131,132,137,140,143,144,151,152,154,170,173,174],centerStationExt=[0,1,2,4,9,12,13,14,15,27,31,34,36,39,40,41,43,44,50,51,54,55,58,59,61,66,67,68,69,72,73,77,78,82,83,90,93,99,100,101,109,111,112,115,116,118,122,123,125,128,129,130,133,134,136,139,142,145,150,153,159,167,168,175,176,177,180,3,7,8,18,19,52,60,62,64,70,75,88,98,110,113,120,131,132,137,140,143,144,151,152,154,170,173,174];function loadLine(e){var t=document.getElementById("lineStations");s="";for(var n=0;n<Sts.length;n++)s+='<div style="margin-top: -3px; margin-bottom: -3px;">',s+='<input id = "st_'+Sts[n].id+'" onclick = "if (checked) addToSel('+n+"); else removeSel("+n+')" type = checkbox style = "width: 10px; vertical-align: middle; margin-right: 5px;" '+(Sts[n].checked?"checked":"")+" value = "+Sts[n].id+">",s+="<label for = st_"+Sts[n].id+">"+Sts[n].name+"</label>",s+="</div>";t.innerHTML=s}function mSel(e){Sts[e].checked?(Sts[e].locked=0,removeSel(e),document.getElementById("imm"+e).src="/img/obana4.gif"):(addToSel(e),incLock(e))}function loadStByLine(){stByLine[8]=[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],stByLine[20]=[21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38],stByLine[21]=[39,40,41,1,42,43,44,45,46,47],stByLine[22]=[48,49,50,51,52,53,54,55],stByLine[24]=[0,56,57,58,59,60,61,62,63,64,65,66],stByLine[28]=[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],stByLine[30]=[21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38],stByLine[31]=[39,40,41,1,42,43,44,45,46,47],stByLine[32]=[48,49,50,51,52,53,54,55],stByLine[34]=[0,56,57,58,59,60,61,62,63,64,65,66]}function stToHtmlFirstPart(e){var t="";for(i=0;i<e.length;i++)t="",t+="<div "+divStyle+">",t+='<input id="clear" '+inputStyle+' style="cursor:hand;cursor:pointer" onclick = "removeAll(); return false" type = checkbox>',t+="<label for = clear "+labelStyle+"><i>&nbsp;Очистить список</i></label>",t+="</div>";return t}function stToHtmlSecondPart(e){var t="";for(i=0;i<e.length;i++){var n=document.getElementById("sel"+e[i]);if(null==n||void 0==n){var l="";l=Sts[e[i]].lineid>0?'<img src="/img/subway'+Sts[e[i]].lineid+'.gif" style="cursor:hand;cursor:pointer" onclick="javascript:DopCheck('+e[i]+')">':'<img src="/img/spacer.gif">',t+='<div id = "sel'+e[i]+'" '+divStyle+">",t+='<input id = "stS_'+e[i]+'" '+inputStyle+' style="cursor:hand;cursor:pointer" onclick="removeSel('+e[i]+'); return false" type="checkbox" checked name="m[]" value="'+Sts[e[i]].id+'">&nbsp;',t+="<label for = stS_"+e[i]+" "+labelStyle+' style="cursor:hand;cursor:pointer" >'+l+"&nbsp;"+Sts[e[i]].name+"</label>",t+="</div>"}}return t}function lSel(e){for(1==lines[e]?lines[e]=0:lines[e]=1,i=0;i<stByLine[e].length;i++)addToSel(stByLine[e][i]),1!=lines[e]?(decLock(stByLine[e][i]),0==showLock(stByLine[e][i])&&removeSel(stByLine[e][i])):incLock(stByLine[e][i])}function incLock(e){return void 0==Sts[e].locked?Sts[e].locked=1:Sts[e].locked=Sts[e].locked+1}function decLock(e){return void 0==Sts[e].locked||Sts[e].locked<=0?Sts[e].locked=0:Sts[e].locked=Sts[e].locked-1}function showLock(e){return Sts[e].locked}function lSelCenter(e){var t,n,l;for(void 0==e?(t="center",n=centerStation):(t="extCenter",n=centerStationExt),l=document.getElementById("selectedStations"),1==lines[t]?lines[t]=0:(lines[t]=1,0==count&&(l.innerHTML=stToHtmlFirstPart(n)),l.innerHTML+=stToHtmlSecondPart(n)),i=0;i<n.length;i++){var c=n[i],s=document.getElementById("sel"+c),o=document.getElementById("st_"+Sts[c].id);o&&(o.checked=!0),Sts[c].checked=!0;var d=document.getElementById("imm"+c);null!=d&&(d.src="/img/obana5.gif"),count++,1!=lines[t]?(decLock(c),0==showLock(c)&&(void 0!=s&&null!=s&&l.removeChild(s),o&&(o.checked=!1),0==--count&&(document.getElementById("selectedStations").innerHTML=emptyText),Sts[c].checked=!1,d.src="/img/obana4.gif")):incLock(c)}}function DopCheck(e){Sts[e].checked?removeSel(e):addToSel(e)}function loadAll(){document.body.style.cursor="wait";var e=document.getElementById("lineStations");e.innerHTML="";for(var t="",n="",i=0;i<Sts.length;i++)n=Sts[i].lineid>0?'<img src="/img/subway'+Sts[i].lineid+'.gif" style="cursor:hand;cursor:pointer" onclick="javascript:DopCheck('+i+')">':'<img src="/img/spacer.gif">',t+="<div "+divStyle+">",t+='<input id = "st_'+Sts[i].id+'" style="cursor:hand;cursor:pointer" onclick = "if (checked) addToSel('+i+"); else removeSel("+i+')" type="checkbox" '+inputStyle+" "+(Sts[i].checked?"checked":"")+' value="'+Sts[i].id+'">&nbsp;',t+="<label for = st_"+Sts[i].id+" "+labelStyle+' style="cursor:hand;cursor:pointer" >'+n+"&nbsp;"+Sts[i].name+"</label>",t+="</div>";e.innerHTML=t,document.body.style.cursor="default"}function InitloadAll(){loadAll();for(var e="",t=0;t<Sts.length;t++)e=e+'<div id="s'+Sts[t].id+'" style="position:absolute; left:'+Sts[t].x+"; top:"+Sts[t].y+';"><img id="imm'+t+'" alt="'+Sts[t].name+'" src="/img/obana4.gif" onclick="JavaScript:mSel('+t+');" style="cursor:hand;cursor:pointer"></div>';for(t=0;t<SelSts.length;t++)for(var n=0;n<Sts.length;n++)SelSts[t]==Sts[n].id&&addToSel(n);0==count&&(document.getElementById("selectedStations").innerHTML=emptyText)}var IE=null!=document.all;function addToSel(e){var t=document.getElementById("selectedStations");0==count&&(s="<div "+divStyle+">",s+='<input id="clear" '+inputStyle+' style="cursor:hand;cursor:pointer" onclick = "removeAll(); return false" type = checkbox>',s+="<label for = clear "+labelStyle+"><i>&nbsp;Очистить список</i></label>",s+="</div>",t.innerHTML="");var n=document.getElementById("sel"+e),i="";null==n?(i='<img src="/img/close.png" style="cursor:hand;cursor:pointer" onclick="javascript:removeSel('+e+')"/>',s='<div id = "sel'+e+'" class="station">',s+='<input id = "stS_'+e+'" type="hidden" name="m[]" value="'+Sts[e].id+'">',s+="<label for = stS_"+e+" >&nbsp;"+Sts[e].name+i+"</label>",s+="</div>",t.innerHTML+=s):n.style.display="";var l=document.getElementById("st_"+Sts[e].id);l&&(l.checked=!0),Sts[e].checked=!0;var c=document.getElementById("imm"+e);null!=c&&(c.src="/img/obana5.gif"),count++}function addToSelAll(e){for(var t=0;t<Sts.length;t++)if(!Sts[t].checked&&Sts[t].line==e){var n=document.getElementById("st_"+Sts[t].id);n.checked||(n.checked=!0,addToSel(t))}}function removeSelAll(e){for(var t=0;t<Sts.length;t++)if(Sts[t].checked&&Sts[t].line==e){var n=document.getElementById("st_"+Sts[t].id);n.checked&&(n.checked=!1,removeSel(t))}}function removeSel(e){var t=document.getElementById("sel"+e);document.getElementById("selectedStations").removeChild(t);var n=document.getElementById("st_"+Sts[e].id);n&&(n.checked=!1),0==--count&&(document.getElementById("selectedStations").innerHTML=emptyText),Sts[e].checked=!1,document.getElementById("imm"+e).src="/img/obana4.gif",updateSel()}function removeAll(){for(i=0;i<Sts.length;i++)if(Sts[i].checked){var e=document.getElementById("st_"+Sts[i].id);e&&(e.checked=!1),Sts[i].checked=!1,document.getElementById("imm"+i).src="/img/obana4.gif"}count=0,document.getElementById("selectedStations").innerHTML=emptyText}loadStByLine();